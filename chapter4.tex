\chapter{МЕТОДЫ НАХОЖДЕНИЯ ОПТИМАЛЬНЫХ ЗНАЧЕНИЙ}\label{chap4}

Идея настоящей работы основана на подходах традиционно используемых при управлении химическими процессами [9]. В химической промышленности управление процессом должно учитывать целый ряд целей: доходность производства, его эффективность, безопасность, устойчивость и другое. В результате постоянно варьирующихся условий, цели управления часто изменяются, соответственно, должны корректироваться стратегии управления процессом производства.

В силу вышесказанного при управлении химическими процессами принято разделять экономические цели и процесс управления на 2 этапа. На первом этапе, который называется RTO выбирается экономическая целевая функция  и формулируется задача оптимизации при ограничениях, задающихся существенными условиями (ценами на рынке, объемами запасов и так далее). Результатом этапа RTO является положение равновесия системы (steady-state). На втором этапе применяются методы теории упрпавления, в частности, в последние годы большую популярность преобретают методы управления про прогнозированию. Модели-MPC, для стабилизации слежения за полученными равновесиями траектории. 

В настоящей главе приводятся основные сведения, относящиеся к этапам RTO и MPC.

\section{Оптимизация в реальном времени}

Как правило, RTO выполняется с гораздо большим периодам выборки и может быть вычислено порядка часов-дней, чем управление по прогнозирующей модели. RTO отвечает за оптимизацию процесса как следует из его названия. Эти обязанности могут быть обобщены в четырехшаговом алгоритме:

\begin{enumerate}
	\item RTO систематически анализирует данные процесса, чтобы определить, достигла ли система устойчивого состояния.
	\item когда устойчивое состояние найдено, завершается проверка и согласование данных.
	\item оценка параметров и обновление модели с использованием различных методов.
	\item решается, применять ли новые условия(то есть отправлять вычисленное состояние на уровень, который переводит операцию процесса во вновь вычисленное установившееся состояние)
\end{enumerate}

RTO стала важной информационной системой в промышленности, у RTO есть три основных недостатка.Во-первых, использует более сложные нелинейные стационарные модели.Во-вторых, оптимизация (или повторная оптимизация) завершается после обнаружения устойчивого состояния процесса. Поскольку процесс по своей природе динамичен и, возможно, находится под воздействием изменяющихся во времени помех, ожидание того, что процесс достигнет устойчивого состояния, может задержать вычисление новых оптимальных условий. Таким образом, повторная оптимизация может проводиться нечасто, что отрицательно влияет на производительность процесса. Одним из решений этой проблемы является частое решение проблемы оптимизации, но это может привести к проблемам стабильности замкнутой системы. В-третьих, не используется управление типа обратной связи.

Динамическое RTO имеет структуру, аналогичную MPC, в том смысле, что обе проблемы оптимизации, которые характеризуют эти системы, как правило, являются задачами динамической оптимизации, которые работают для минимизации экономической цели в зависимости от модели динамического процесса.
	
\section{Управление по прогнозирующей модели}
Управление по прогнозирующей модели задается следующей задачей динамической оптимизации:

\begin{align}
	\int_0^{\tau_N} (x^2(t) &+ u^2(t)) dt \to \min \label{MPC_J} \\
	\dot{x}(t) &= f(x(t), u(t)) \label{MPC_x} \\
	x(0) &= x_{\tau_k} \label{MPC_x0} \\
	g(x(t), u(t)) &\le 0, \quad \forall t \in [0, \tau_N) \label{MPC_g}
\end{align} 
где траектория состояния $x(t)$ является предсказанной эволюцией состояния. Начальные условия на динамической модели
приведены в формуле (\ref{MPC_x0}), которые получаются в каждый период выборки через измерение текущего состояния. Ограничения уравнения (\ref{MPC_g}) - это ограничения процесса, наложенные на входные данные и состояния, которые обычно являются точечными ограничениями. (\ref{MPC_g}) обычно записываются как:

\[
	g(x_{\tau_j}, u_{\tau_j}) \le 0, \quad j = 0,1, \dots, N. 
\]

Когда горизонт прогнозирования $N$ конечен, хорошо известно, что схема MPC для задачи (\ref{MPC_J})-(\ref{MPC_g}) не может быть стабилизирующей. Различные ограничения и изменения в функции стоимости могут быть сделаны, чтобы гарантировать стабильность замкнутой системы, когда $N$ конечно. 

Чтобы устранить недостатки двухуровневой иерархической структуры управления RTO и MPC, может быть введен промежуточный уровень, называемый целевым (стационарным). Целевой уровень - преобразует оптимальное стационарное состояние, вычисленное на уровне RTO, в достижимую точку для уровня управления с обратной связью (MPC). 

В частности, квадратичная программа или линейная программа используется для преобразования недостижимого желаемого устойчивого состояния в достижимую цель, а затем MPC в задаче (\ref{MPC_J})-(\ref{MPC_g}) принуждает замкнутый контур к достижимой цели. Целевая оптимизация или первый этап двухэтапного MPC также позволяет проводить более частую оптимизацию, поскольку она обычно выполняется с той же скоростью, что и MPC.

Ранние исследования по этой теме было сосредоточено на объединении стационарной экономической оптимизации и линейного MPC в одну задачу оптимизации. В частности, схемы MPC, которые интегрируют стационарную оптимизацию, используют функцию стоимости в виде:

\[
	J_{MPC/RTO} (x(t), u(t)) = \int_0^{\tau_N} (x^2(t) + u^2(t)) dt + l_e(x_{\tau_N}, u_s)
\]
которая имеет как квадратичный (отслеживающий) компонент, так и функцию затрат. Эта схема MPC имеет следующую общую формулировку:

\begin{gather}
	J_{MPC/RTO} (x(t), u(t)) \to \min \label{new_MPC_J} \\ 
	\dot{x}(t) = f(x(t), u(t)) \label{new_MPC_x} \\
	x(0) = x_{\tau_k} \label{new_MPC_x0} \\
	f(x_{\tau_N}, u_s) = 0, \quad u_s \in U \label{new_MPC_f} \\
	g(x(t), u(t)) \le 0, \quad \forall t \in [0, \tau_N) \label{new_MPC_g}
\end{gather}
где переменные задачи оптимизации включают в себя как входную траекторию по прогнозирующему горизонту, так и установившийся входной сигнал. Ограничение уравнения (\ref{new_MPC_f}) обеспечивает, что траектория предсказанного состояния x(t) сходится к допустимому промежуточному состоянию. Остальные ограничения и обозначения аналогичны задаче (\ref{MPC_J})-(\ref{MPC_g}).

%\section{Управление по прогнозирующей модели}

%Основным достоинством управления по прогнозирующей модели является относительная простота формирования обратной связи. Это  позволяет управлять многосвязными и многомерными объектами со сложной структурой, таких как нелинейности, оптимизация процессов в режиме реального времени в рамках ограничений на управляемые и управляющие переменные,а так же учитывать неопределенности в задании объектов и возмущений. Кроме того, возможно учитывать транспортное запаздывание, изменение критериев качества в ходе процесса и отказов датчиков системы измерения.

Подход MPC составляет следующая схема управления динамическими объектами типа обратной связи:

\begin{enumerate}
	\item Рассматривается некоторая математическая модель. Начальными условиями служит его текущее состояние. При заданном  управлении выполняется интегрирование уравнений математической модели, что дает прогноз движения объекта на некотором конечном отрезке времени.
	\item Выполняется оптимизация управления. Цель-приближение регулируемых переменных прогнозирующей модели к соответствующим задающим сигналам на отрезке времени. Оптимизация осуществляется с учётом всех ограничений, наложенных на регулируемые и управляющие переменные.
	\item На фиксированном небольшом отрезке времени, реализуется найденное оптимальное управление и осуществляется восстановление по измеренным переменным фактического состояния объекта на конечном шаге.
	\item Отрезок времени (или горизонт прогноза) сдвигается на шаг вперед, и повторяются пункты 1-3. 
\end{enumerate}

Заметим, что в силу отличия динамики реального объекта и прогнозирующей модели их движения на рассмотренном отрезке будут отличаться, а совпадение гарантируется только в начальной точке.

Если положить $\tau_N \to \infty$ и осуществлять прогноз от точки $t = 0$ на бесконечном интервале времени $t \in [0, \infty)$, можно найти управление и реализовать его в виде $u(t) = u^*(t)$
для модели (\ref{MPC_J})-(\ref{MPC_g}). Считаем, что целью управления является выполнение равенств:
\[
	\lim_{t \to \infty} \| x(t) - r_x(t) \| = 0, \quad \lim_{t \to \infty} \|u(t) - r_u(t) \| = 0
\]
где $r_x(t)$ и $r_u(t)$ - векторные функции, которые заданы и  определяют желаемое движение объекта. Такое управление будет решением задачи оптимизации для реального объекта по отношению к функционалу

\begin{equation}
	J_0 (x(t),u(t)) = \int_0^{\infty} F(x(t, x(0), u(t)), u(t), r_x(t), r_u(t)) dt.
\end{equation}

Нахождение управления на базе однократного прогноза приводит к значительным отклонениям от оптимального. Для улучшения ситуации, выполняется многократный прогноз с периодам $\delta$. Однако такой подход обладает как минимум двумя недостатками. Во-первых, на каждом отрезке управление осуществляется по разомкнутой схеме, то есть, без обратной связи, что в ряде случаев недопустимо. Во-вторых, ввиду отличия реальной динамики от прогнозируемой, движение под воздействием принятого управления может существенно отличаться от оптимального.

Принято говорить, что такой способ оптимизации управления с предсказанием использует прогноз с подвижным горизонтом.

Общая схема управления с предсказанием описвается следующим образом:

\begin{enumerate}
	\item Оценивание  или измерение вектора состояния  реального объекта.
	\item Решение задачи (\ref{MPC_J})-(\ref{MPC_g}).
	\item Использование найденной оптимальной функции $u^*$ в качестве программного управления на отрезке $\tau \in [t, t+\delta]$.
	\item Замена момента времени $t$ на момент $t+\delta$ и повторение операций в пунктах 1-3.
\end{enumerate}

Приведенная схема реализуется в системе управления с обратной связью.

Подводя итог можно выделить некоторые особенности схемы управления с предсказанием.

\begin{enumerate}
	\item Можно использовать нелинейные системы обыкновенных дифференциальных уравнений в качестве прогнозирующей модели.
	\item Управление по прогнозирующей модели позволяет учитывать ограничения, которые наложены на управляющие переменные,и на вектора состояния.
	\item Подход предусматривает минимизацию функционала,который характеризует качество управления, в режиме реального времени.
	\item Предсказанное поведение динамического объекта, отличается от его реального движения.
	\item Управлению с предсказанием необходимо, чтобы текущее состояние объекта измерялось или оценивалось.
\end{enumerate}
\bigskip
%Каждая глава завершается краткими выводами. Разумный способ написания выводов --- переписать (это значит использовать те же мысли, но не копировать фразы!) в утвердительной форме (рассмотрено, получено и т.д.) то, что написано во врезке. 