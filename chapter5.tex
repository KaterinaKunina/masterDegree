\chapter{АЛГОРИТМ РЕШЕНИЯ ЗАДАЧ ОПТИМАЛЬНОГО УПРАВЛЕНИЯ МЕТОДОМ УПРАВЛЕНИЯ ПО ПРОГНОЗИРУЮЩЕЙ МОДЕЛИ}\label{chap5}

В настоящей главе предлагается использовать методы управления по прогнозирующей модели для отслеживания магистралей в задачах экономической динамики. Рассматривается две экономических задачи: неоклассическая модель экономического роста, аналитическое решение которой построено в работе \cite{Kryazhimski} и задача экономического роста открытой экономики, решение которой было получено в дипломной работе \cite{Diplom}.

\section{Задача оптимизации неоклассической модели экономического роста}

Неоклассическая модель оптимального экономического роста описывает замкнутую агрегированную экономику, производящую в каждый момент времени $t \geqslant 0$ единственный однородный продукт ($\equiv$ капитал) со скоростью $Y(t) > 0$. В каждый момент времени $t$
величина $Y(t)$ является функцией текущих значений капитала $K(t) > 0$ и трудовых ресурсов $L(t) > 0$; трудовые ресурсы также предполагаются однородными. Таким образом

\begin{equation}\label{Y=F(K,L)}
	Y (t) = F(K(t), L(t)) \quad \forall t \geqslant 0.
\end{equation}

Функция $F$ обычно называется производственной функцией. Относительно производственной функции $F$ предполагается, что она определена и непрерывна на положительном квадранте

\[
	G = {(K,L) \in R^2: K > 0, L > 0},
\]
дважды непрерывно дифференцируема и удовлетворяет следующим “неоклассическим” условиям для всех $K >0, L > 0$:

 \begin{align} 
  		 \frac{\partial F(K, L)}{\partial K} > 0, &\quad \frac{\partial^2 F(K,L)}{\partial K^2} < 0 \label{inada_condition1} \\
  		\frac{\partial F(K, L)}{\partial L} > 0, &\quad \frac{\partial^2 F(K,L)}{\partial L^2} < 0 \label{inada_condition2}\\
  		\lim_{K \to +0} \frac{\partial F(K, L)}{\partial K} = \infty, &\quad \lim_{K \to \infty} \frac{\partial F(K, L)}{\partial K} = 0 \label{inada_condition3}\\
  		\lim_{L \to +0} \frac{\partial F(K, L)}{\partial L} = \infty, &\quad \lim_{L \to \infty} \frac{\partial F(K, L)}{\partial L} = 0 \label{inada_condition4}
 \end{align}
 
Наконец, предполагается, что $F$ положительно однородна первой степени, т.е.

\begin{equation} \label{F(aK,AL)=aF(K,L)}
	F(\lambda K, \lambda L) = \lambda F(K, L) \quad \text{для любых} \quad \lambda > 0, K > 0, L > 0.
\end{equation}

Последнее условие означает, что объем производства в каждую единицу времени прямо пропорционален величинам имеющихся в эту единицу времени производственных факторов. В качестве производственной функции $F$ может фигурировать, например, стандартная функция Кобба–Дугласа вида

\[
	F(K, L) = A K^{\alpha} L^{1 - \alpha}, \quad \alpha \in (0, 1)
\]
где $A > 0$. 

Заметим, что в силу равенства (\ref{F(aK,AL)=aF(K,L)}) не все условия в (\ref{inada_condition1})–(\ref{inada_condition4}) независимы. В частности, второе условие в (\ref{inada_condition2}) следует из второго условия в (\ref{inada_condition1}) и (\ref{inada_condition4}). 

В замкнутой экономике произведенный продукт либо инвестируется в основные производственные фонды (капитал), либо потребляется. Предположим, что в каждый момент времени $t \geqslant 0$ минимально возможная часть потребляемого продукта есть $ \varepsilon Y (t) > 0$, где $0 < \varepsilon < 1$ — некоторая постоянная, а доля продукта $(1-\varepsilon)Y(t)$ может быть распределена между производством и потреблением произвольным образом. 

Пусть в момент времени $t \geqslant 0$ часть

\begin{equation} \label{I(t)=u(t)Y(t)}
	I(t) = u(t)Y(t), \quad 0 \leqslant u(t) \leqslant 1 - \varepsilon,
\end{equation}
произведенного продукта инвестируется в основные производственные фонды, а оставшаяся часть

\begin{equation} \label{C(t)}
	C(t) = (1 - u(t))Y(t)
\end{equation}
потребляется.

В дальнейшем величина $u(t) \in [0, 1 - \varepsilon]$ будет трактоваться как значение управления в момент времени $t$. \\

В данной модели амортизации капитала не предполагается. Поэтому в силу равенства (\ref{I(t)=u(t)Y(t)}) динамика изменения капитала при $t \geqslant 0$ может быть описана при помощи следующего дифференциального уравнения:

\begin{equation} \label{dif_K}
	\dot{K}(t)=I(t)=u(t)Y(t).
\end{equation}

Считаем, что в начальный момент времени $K(0) = K_0 > 0$.
Пусть трудовые ресурсы удовлетворяют условию экспоненциального роста, т.е.

\begin{equation} \label{dif_L}
	\dot{L}(t) = \mu L(t),
\end{equation}
где $\mu > 0$ —- некоторая постоянная. Аналогично будем считать, что $L(0) = L_0 > 0$. 

Пусть $\rho > 0$ —- параметр дисконтирования и в каждый момент времени $t \geqslant 0$ мгновенная полезность $g(K(t), L(t), u(t))$ текущего процесса управления есть логарифм полного потребления $C(t)$, т.е. (см. (\ref{Y=F(K,L)}), (\ref{C(t)}))

\[
	g(K(t), L(t), u(t)) = \ln C(t) = \ln (1-u(t)) + \ln F(K(t), L(t)).
\]

Неоклассическая модель оптимального экономического роста (c логарифмической функцией мгновенной полезности) формулируется в виде следующей задачи оптимального управления ($P_\varepsilon$), $0 < \varepsilon < 1$:

\begin{equation} \label{P_epsilon}
  \begin{split}
  		J(K,L,u) = \int_0^\infty e^{-\rho t} [\ln (1-u(t)) &+ \ln F(K(t),L(t))] dt \to \max, \\
  		\dot{K}(t) = u(t)F(K(t), L(t)),& \quad u(t) \in U_{\varepsilon} = [0, 1 - \varepsilon], \\
  		\dot{L}(t) = &\mu L(t), \\
  		K(0) = K_0, &\quad L(0) = L_0.
  \end{split}
\end{equation}

Задача ($P_{\varepsilon}$) удовлетворяет условиям (A1)–(A3) и является частным случаем задачи ($P$). 

При исследовании неоклассической задачи оптимального экономического роста обычно, используя условие однородности (\ref{F(aK,AL)=aF(K,L)}), понижают размерность системыи переходят к вспомогательной фазовой переменной $x = K/L$ (величине капитала, приходящегося на единицу рабочей силы) и однофакторной производственной функции $f$ вида $f(x) = F(x, 1), x > 0$.
В этом случае в силу условий (\ref{Y=F(K,L)}) и (\ref{F(aK,AL)=aF(K,L)}) для любого $t \geqslant 0$

\[
	\frac{Y(t)}{L(t)} = \frac{1}{L(t)} F(K(t), L(t)) = F \Biggl( \frac{K(t)}{L(t)}, 1 \Biggr) = f(x(t)).
\]

Функция $f$ определена и непрерывна на $\tilde G = (0, \infty)$. В силу условий (\ref{inada_condition1}) для всех $x > 0$

\begin{equation}
	\frac{d}{dx} f(x) > 0, \quad \frac{d^2}{dx^2} f(x) < 0
\end{equation}
и вследствие (\ref{inada_condition1}) - (\ref{F(aK,AL)=aF(K,L)})

\begin{equation}\label{Ex1_conditions}
  \begin{split}
	&\lim_{x \to +0} f(x) = 0, \quad \lim_{x \to \infty} f(x) = \infty, \\
	 &\lim_{x \to +0} \frac{d}{dx} f(x) = \infty, \quad \lim_{x \to \infty} \frac{d}{dx} f(x) = 0.
  \end{split}	
\end{equation}

Для переменной $x(t) = K(t)/L(t)$ в силу равенств (\ref{dif_K}) и (\ref{dif_L}) имеем

\[  
	\dot{x}(t) = \frac{d}{dt} \frac{K(t)}{L(t)} = \dot{K}(t) \frac{1}{L(t)} - \frac{K(t)}{L^2(t)} \dot{L}(t) = u(t) \frac{Y(t)}{L(t)} - \mu \frac{K(t)}{L(t)},
\]
откуда в силу определения переменной $x$ и условий (\ref{Y=F(K,L)}) и (\ref{F(aK,AL)=aF(K,L)}) вытекает равенство

\[
	\dot{x}(t) = u(t) f(x(t)) - \mu x(t).
\]

Величина мгновенного потребления на единицу трудовых ресурсов в момент времени $t \geqslant 0$ есть $c(t) = C(t)/L(t)$. Согласно (\ref{Y=F(K,L)}) и (\ref{C(t)}) получаем

\[
	c(t) = (1-u(t)) \frac{Y(t)}{L(t)} = (1 - u(t)) f(x(t)).
\]

Заметим, что в силу равенства (\ref{dif_L}) трудовые ресурсы $L$ в рассматриваемой модели подчиняются заранее заданной динамике. Поэтому максимизация интегрального функционала (\ref{P_epsilon}) эквивалентна задаче максимизации функционала

\[
	J(x, u) = \int_0^\infty e^{-\rho t} \ln c(t) dt = \int_0^\infty e^{-\rho t} [\ln(1 - u(t)) + \ln f(x(t))] dt,
\]
характеризующего агрегированную удельную скорость роста потребления на единицу рабочей силы. 

Таким образом, в терминах фазовой переменной $x$ задача оптимального управления $(P_\varepsilon), 0 < \varepsilon < 1$, переписывается в виде следующей задачи ($\tilde P_\varepsilon$):

\begin{align*}
	J(x,u) = \int_0^\infty e^{-\rho t} [\ln(1- &u(t)) + \ln f(x(t))] dt \to \max, \\
	\dot{x}(t) = u(t) f(x(t)) - &\mu x(t), \quad u(t) \in U_\varepsilon=[0, 1 - \varepsilon],\\
	x(0) &= x_0.
\end{align*}

Здесь $x_0 \in \tilde G = (0,\infty)$.

Решением задачи является оптимальный процесс $x^*, u^*$, при котором качество потребления и инвестиций принимает наибольшее значение.

Построим гамильтониан: 
\[
	H(x, \lambda, u) = ln(1-u)+ln(f(x)) + \lambda(uf(x))-\mu x)     \]
где $\lambda$ –- сопряженная переменная.

Запишем дифференциальное уравнение для сопряженной переменной:
\[
\dot{\lambda} = \frac{f'(x)}{f(x)} + \lambda f'(x) - \mu.
\]

Перепишем эту систему вместе с исходными дифференциальными уравнениями в виде системы:
\begin{equation}\label{Ex1_dif_system}
\begin{split}
 \frac{\dot{x}}{dt} &= uf(x) - \mu x, \\
 \frac{\dot{\lambda}}{dt} &= \frac{f'(x)}{f(x)} + \lambda uf'(x) - \mu.
\end{split}
\end{equation}

Помним, что выполняются условия (\ref{Ex1_conditions}).

У системы (\ref{Ex1_dif_system}) существует стационарное решение $x(t) \equiv x^* - const, u(t) \equiv u^* - const$ (для него $\frac{dx^*}{dt} = \frac{du^*}{dt} \equiv 0$). Оно находится приравниванием нулю правых частей этих уравнений:
\begin{equation}\label{Ex1_steady_state}
\begin{split}
	f'(x^*) &= \rho + \mu, \\
	u^* &= \frac{\mu x^*}{f(x^*)}.
\end{split}
\end{equation}

Найденным значениям констант $x^*, u^*$ соответствует единственная так называемая траектория сбалансированного роста (стационарный режим).

%Эта траектория с экономической точки зрения является очень привлекательной. Она отвечает ситуации, когда осуществляется воспроизводство, позволяющее при постоянном потреблении и инвестировании поддерживать капитал на стационарном уровне $k = k^*$.

Так как устойчивое состояние найдено, можно составить прогнозирующую ЗОУ (см. подразд. \ref{chap4}.2) для управления по прогнозирующей модели:
\begin{align}  \label{Example1_MPC}
J(x,u) = \int_0^{\tau_N} &(|x(t)- x^*|_2^2 + |u(t) - u^*|_2^2 dt \to \min, \\
	\dot{x}(t) &= u(t) f(x(t)) - \mu x(t), \quad x(0) = x_{\tau_p} \\
	u_s &f(x_{\tau_N}) - \mu x_{\tau_N} = 0, \\
	&0 \leqslant u(t) \leqslant 1-\varepsilon, \quad t \in [0, \tau_N). \label{Example1_MPC_end}
\end{align}

Для дискретизации задачи (\ref{Example2_MPC})-(\ref{Example2_MPC_end}) использовался метод Рунге-Кутты 4-го порядка \cite{differential}.

Построение и анализ магистралей для конкретного набора параметров описан в главе \ref{chap6}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Задача оптимизации открытой экономики}

Рассмотрим модель открытой экономики, которая имеет возможность использовать внешний кредит. В такой экономике капитал $K(t)$, участвующий в производстве, складывается из собственного капитала (активов) $A(t)$ и величины внешнего кредита $B(t)$: 
\begin{equation}\label{Open_economic_K(t)}
	K(t) = A(t) + B(t), \quad t \in T.
\end{equation}

Предполагается, что экономика может только брать кредит, но сама не является кредитодателем, т.о. размер кредита не может быть отрицательным. Кроме того, она не может превышать определенного подушевого лимита $b^*$. Таким образом, ограничения на величину $B(t)$ имеют вид: 
\begin{equation}\label{confines_B(t)}
 0 \leqslant B(t) \leqslant b^* L(t), t \in T.
\end{equation}

В каждый момент времени $t$ величина $\dot{B}(t)$ характеризует скорость получения дополнительных средств (если $\dot{B}(t) > 0$), или выплаты долга (если $\dot{B}(t) < 0$). Поэтому $Y(t) + \dot{B}(t)$ есть объем средств, которыми экономика может распоряжаться в момент времени $t$. Эти средства полностью распределяются между:
\begin{itemize}
  \item  выплатой процентов (по ставке $r$) по кредиту, в объеме $rB(t)$;
  \item потреблением $C(t))$;
  \item инвестициями $I(t)$,
\end{itemize}
что влечет следующее балансовое тождество:
\[
	Y(t) + \dot{B}(t) = r B(t) + C(t) + I(t), t \in T.
\]
 
Изменение капитала описывается стандартным уравнением
\begin{equation} \label{change_K(t)}
 \dot{K} = I - \delta K,
\end{equation} 
где $\delta$ –- норма амортизации капитала.

Численность рабочих меняется согласно
\[
	\dot{L} = nL,
\]
где $n$ --- темп роста.
 
В рассматриваемой модели удобно с помощь балансового тождества (\ref{Open_economic_K(t)}) перейти от уравнения (\ref{change_K(t)}) к дифференциальному уравнению для собственного капитала: 
\begin{align} \label{Open_economic_A(t)}
 \dot{A} = &\dot{K} - \dot{B} = \delta K + I + Y - rB - C - I = \\
 &= rA + F(K,L) - (\delta + r)K - C.
\end{align}

В интенсивных переменных $a = \frac{A}{L}$, $k$, $c$, $i$ модель экономического роста с использованием кредита примет вид:
\begin{equation}\label{economic_model_with_credit}
	\dot{a} = (r - n)a + f(k) - (\delta + r)k - c, \dot{k} = -(\delta + n)k + i.
\end{equation}

Система уравнений (\ref{economic_model_with_credit}) называется моделью экономического роста с использованием внешнего кредита. Считается, что начальные значения собственного и общего капиталов для (\ref{economic_model_with_credit}) заданы: $a(0) = a_0, k(0) = k_0$.

Переменные $a, k$ будем трактовать как фазовые, переменные $c, i$ -- как управления.

Из физического смысла переменной $a$ и неравенств (\ref{confines_B(t)}) следуют ограничения на фазовые переменные (фазовые ограничения):
\begin{equation}
0 \leqslant a(t) \leqslant k(t) \leqslant a(t) + b^*, t \in T.
\end{equation}

Качество программы потребления и инвестиций оценим с помощью
функционала
\[
 J(c,i) = e^{-\rho z}a(z) + \int_0^z e^{-\rho t}c(t) dt,
\]
где $\rho$ -- норма дисконтирования. Считаем, что $\rho \not= r - n$.

Таким образом, задача оптимального экономического роста с
использованием кредита свелась к следующей задаче оптимального управления с фазовыми ограничениями:
\begin{align} \label{Example2}
	 J(c,i) = e^{-\rho z} &a(z) + \int_0^z e^{-\rho t}c(t) dt \to \max, \\
	 \dot{a}=(r-n)a &+ f(k)-(\delta +r)k-c, a(0)=a_0, \\
	 \dot{k} = &-(\delta + n)k + i, k(0)=k_0, \\
	 &c(t) \geqslant 0, i(t) \geqslant 0, \\
	 0 \leqslant a(&t) \leqslant k(t) \leqslant a(t) + b^*, t \in T. \label{Example2_end}
\end{align}

Решением задачи является оптимальный процесс $k^*, a^*, c_*, i_*$, при котором качество потребления и инвестиций принимает наибольшее значение.

Построим гамильтониан: 
\begin{multline}
	H(a, k, \lambda, c, i) = \lambda_1 ((r-n)a + f(k) - (\delta + r)k - c) + \lambda_2 (-(\delta+n)k+i) + c + \\ 
	+ \nu_0 a +\nu_1 (k - a) + \nu_2 (a+ b^* - k), \notag
\end{multline}
где $\lambda_1, \lambda_2$ -- сопряженные переменные, $\nu_0, \nu_1, \nu_2$ -- функциональные множители Лагранжа, соответствующие фазовым ограничениям. 

Запишем сопряженную систему состоящую из двух дифференциальных уравнений:
\[
\dot{\lambda_1} = (\rho + n -r) \lambda_1 - \nu_0 + \nu_1  - \nu_2, 
\]
\[
 \dot{\lambda_2} = (\rho +\delta +n) \lambda_2 - \lambda_1 (f'(k) - \delta - r) - \nu_1 + \nu_2,
\]

Перепишем эту систему вместе с исходными дифференциальными урав-
нениями в виде системы:
\begin{equation}\label{dif_system}
\begin{split}
	\dot{\lambda_1} = &(\rho + n -r) \lambda_1 - \nu_0 + \nu_1  - \nu_2, \\
	 \dot{\lambda_2} = &(\rho +\delta +n) \lambda_2 - \lambda_1 (f'(k) - \delta - r) - \nu_1 + \nu_2, \\
	 \dot{a}=& (r-n)a + f(k)-(\delta +r)k-c, \\
	 \dot{k} = &-(\delta + n)k + i.
\end{split}
\end{equation}

У системы (\ref{dif_system}) существует стационарное решение $a(t) \equiv a^* - const, k(t) \equiv k^* - const, c(t) \equiv c_* - const, i(t) \equiv i_* - const$ (для него $\frac{da^*}{dt} = \frac{dk^*}{dt} = \frac{dc_*}{dt} = \frac{di_*}{dt} \equiv 0$). Оно находится приравниванием нулю правых частей этих уравнений:
\begin{equation}\label{Ex2_steady_state}
\begin{split}
	f'(k^*) &= \rho + \delta + n, \\
	c_* &= f(k^*) - (r + \delta)k^*, \\
	i_* &= (\delta + n)k^*, 
\end{split}
\end{equation}

Найденным значениям констант $c_*, i_*, k^*, a^*$ соответствует единственная так называемая траектория сбалансированного роста (стационарный режим).

Эта траектория с экономической точки зрения является очень привлекательной. Она отвечает ситуации, когда осуществляется воспроизводство, позволяющее при постоянном потреблении и инвестировании поддерживать капитал на стационарном уровне $k = k^*$.

%\begin{figure}[h]
%\noindent\centering{
%\includegraphics[width=120mm]{Ex2.png}
%}
%\caption{Слева отображается поведение магистралей $c(t), i(t)$, изменяющиеся с течением времени $t$. Можно увидеть, что все они выходят на траектории устойчивого роста. Справа изменение оптимальных траекторий с течением времени $t$.}
%\label{figCurves}
%\end{figure} 
Так как устойчивое состояние найдено, можно составить прогнозирующую ЗОУ (см. подразд. 3.2) для управления по прогнозирующей модели:
\begin{align}  \label{Example2_MPC}
J(c,i) = &\int_0^{\tau_N} (|a(t) - a^*|_2^2 + |k(t) - k^*|_2^2 + |c(t) - c_*|_2^2 + |i(t) - i_*|_2^2) dt \to \min, \\
&\dot{a} = (r-n)a + f(k)-(\delta +r)k-c, \quad a(0)=a_{\tau_p}, \\
	 &\dot{k} = -(\delta + n)k + i, \quad k(0)=k_{\tau_p}, \\
	 &(r-n)a_{\tau_N} + f(k_{\tau_N})-(\delta +r)k_{\tau_N}-c_s = 0, \\
	 &-(\delta + n)k_{\tau_N} + i_s = 0, \\
	 &c(t) \geqslant 0, i(t) \geqslant 0, \\
	 &0 \leqslant a(t) \leqslant k(t) \leqslant a(t) + b^*, t \in [0, \tau_N). \label{Example2_MPC_end}
\end{align}

%Отслеживание магистралей показано на рисунке \ref{figCurves}, заемные средства полностью выплачены – экономика развивается только за счет собственного капитала. 
Для дискретизации задачи (\ref{Example2_MPC})-(\ref{Example2_MPC_end}) использовался метод Рунге-Кутты 4-го порядка \cite{differential}.

Построение и анализ магистралей для конкретных наборов параметров описан в главе \ref{chap6}.

\bigskip

%Каждая глава завершается краткими выводами. Разумный способ написания выводов --- переписать (это значит использовать те же мысли, но не копировать фразы!) в утвердительной форме (рассмотрено, получено и т.д.) то, что написано во врезке. 